<!doctype html>
 
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Bootstrap 3 Form Builder</title>
	<link rel="stylesheet" href="css/jquery.ui.theme.css" />
	<link rel="stylesheet" href="css/bootstrap.css" />
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery.ui.min.js"></script>
	<script src="js/bootstrap.js"></script>
	<style>
	.droppable-active { background-color: #ffe !important; }
	.tools a { cursor: pointer; font-size: 80%; }
	.form-body .col-md-6, .form-body .col-md-12 { min-height: 500px; }
	.draggable { cursor: move; }
	</style>
	<script>
	$(document).ready(function() {
		setup_draggable();		
	});
	
	var setup_draggable = function() {
		$( ".draggable" ).draggable({
			appendTo: "body",
			helper: "clone"
		});
		$( ".droppable" ).droppable({
			accept: ".draggable",
			helper: "clone",
			hoverClass: "droppable-active",
			drop: function( event, ui ) {
				$(".empty-form").remove();
				var $orig = $(ui.draggable)
				if(!$(ui.draggable).hasClass("dropped")) {
					var el_dropped = "#"+$orig.attr('id')+".dropped";
					if(!$(el_dropped).length){
						var $el = $orig.clone().addClass("dropped").addClass("col-xs-12").css({"position": "static", "left": null, "right": null}).appendTo(this);			
					}
					$('<p class="tools"><a class="remove-link">Remove</a> | <a class="edit-size">Size</a></p>').appendTo($el);
				} else {
					console.log($(this)[0]);
					if($(this)[0]!=$orig.parent()[0]) {
						var $el = $orig.clone().css({"position": "static", "left": null, "right": null}).appendTo(this);
						$orig.remove();
					}
				}
			}
		}).sortable();
		
	}
	
	var get_modal = function(modal_id) {
		var modal = $('<div id="modal-'+modal_id+'" class="modal" style="overflow: auto;" tabindex="-1">\
			<div class="modal-dialog">\
				<div class="modal-content">\
					<div class="modal-header">\
						<a type="button" class="close"\
							data-dismiss="modal" aria-hidden="true">&times;</a>\
						<h4 class="modal-title">Change Size</h4>\
					</div>\
					<div class="modal-body ui-front">\
						<div class="form-group col-xs-10">\
							<select class="form-control" id="n-columns">\
								<option value="12">Size 12</option>\
								<option value="11">Size 11</option>\
								<option value="10">Size 10</option>\
								<option value="9">Size 9</option>\
								<option value="8">Size 8</option>\
								<option value="7">Size 7</option>\
								<option value="6">Size 6</option>\
								<option value="5">Size 5</option>\
								<option value="4">Size 4</option>\
								<option value="3">Size 3</option>\
								<option value="2">Size 2</option>\
								<option value="1">Size 1</option>\
							</select>\
						</div>\
						<button class="btn btn-success">Change</button>\
					</div>\
				</div>\
			</div>\
			</div>').appendTo(document.body);
			
		return modal;
	};
	
	$(document).on("click", ".edit-size", function(ev) {
		var $el = $(this).parent().parent();
		var $el_copy = $el.clone();
		var modal_id = '#modal-'+$el.attr("id");
		var $edit_btn = $el_copy.find(".edit-size").parent().remove();
		if(!$(modal_id).length){
			var $modal = get_modal($el.attr("id")).modal("show");
		}else{
			var $modal = $(modal_id).modal("show");
			
		}
		$modal.find(".btn-success").click(function(ev2) {
			var size = $modal.find("select").val();
			$el.removeClass().addClass('form-group').addClass('draggable').addClass('ui-draggable').addClass('dropped').addClass('col-xs-'+size);
			$modal.modal("hide");
			return false;
		})
	});
	
	$(document).on("click", ".remove-link", function(ev) {
		$removing = $(this).parent().parent();
		var modal_remove = "#modal-"+$removing.attr("id");
		$removing.remove();
		if($(modal_remove).length){
			$(modal_remove).remove();
		}
	});
			
	</script>
</head>
<body style="background-color: #ddd;">
	<br />
	<div class="row">
		<div class="col-md-3" style="padding: 0px 30px 30px 30px; background-color: #fff;">
			<h3>Elements</h3>
			<form role="form">
				<div id="email" class="form-group draggable">
					<input type="email" class="form-control" id="input-id-1" placeholder="Enter email">
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="password" class="form-group draggable">
					<input type="password" class="form-control" id="input-password-1" placeholder="Password">
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="select" class="form-group draggable">
					<select class="form-control" id="select-1">
						<option value="Option 1">Option 1</option>
						<option value="Option 2">Option 2</option>
						<option value="Option 3">Option 3</option>
					</select>
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="file" class="form-group draggable">
					<input type="file" id="input-file-1">
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="checkbox" class="form-group draggable">
					<input type="checkbox"> <span >Check me out</span>
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="button" class="form-group draggable">
					<button type="submit" class="btn btn-default" >Submit</button>
					<p class="help-block">Example block-level help text here.</p>
				</div>
				<div id="row" class="form-group draggable">
					<p class="help-block">Spacing Element</p>
				</div>
			</form>
		</div>
		<div class="col-md-9">
			<div style="background-color: #fff; padding: 20px; ">
				<div class="text-muted empty-form text-center" style="font-size: 24px;">Drag & Drop elements to build form.</div>
				<div class="row form-body">
					<div class="col-md-12 droppable sortable" >
					</div>
				</div>
			</div>
		</div>
	</div>
 
</body>
</html>